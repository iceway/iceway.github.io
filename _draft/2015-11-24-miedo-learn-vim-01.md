---
layout: post
title:  "Miedo学VIM（1）"
date: Tue, 24 Nov 2015 18:26:19
categories: Miedo学VIM
tags: vim
---

VIM是一个文本编辑器，名称是**V**i **IM**proved的简写，顾名思义，是改进的vi编辑器。而vi的历史就更早了，vi是Visual的不正规的写法。VIM在vi的基础上增加了很多功能，目前大多数的Linux发行版默认带的是VIM编辑器，但是VIM也提供兼容vi编辑器的模式，可以通过下面的命令看到Linux发行版上的vi命令其实是一个到VIM的软链接，以vi这个名字启动VIM时，会尽可能的模拟vi编辑器的功能。

```console
[iceway@linux-h7zo ~]$ which vi
/usr/bin/vi
[iceway@linux-h7zo ~]$ ls -l /usr/bin/vi
lrwxrwxrwx 1 root root 8 7月  19 2014 /usr/bin/vi -> /bin/vim
```

虽然VIM也是一个文本编辑器，但是和notepad，notepad++，gedit等传统意义上的文本编辑器有很大的不同，而且VIM的学习曲线有些陡峭，掌握起来较慢。可是一旦掌握了VIM，处理文本编辑的效率和notepad等编辑器完全就不在一个等级，这也是为何一直以来VIM都被称为《编辑器之神》，另一个强大到不行的编辑器是被称为《神之编辑器》的Emacs，关于这两个编辑器的更多趣事可以看看[《Emacs和Vim：神的编辑器和编辑器之神》][emacs_vim_1]和[《Emacs VS Vi：编辑器之战》][emacs_vim_2]。

[emacs_vim_1]: http://os.51cto.com/art/201101/242518.htm
[emacs_vim_2]: http://www.guokr.com/post/64003/

VIM是一个终端下的编辑器，但是也提供了图形界面版本gvim，不过对于程序员来说，可能用终端的更快捷方便，至少我一直用vim。

## 模式

前面说了vim和传统文本编辑器有很大不同，VIM最大的特点就在于它有不同的模式，VIM的高效、强大和学习难度太高都源于VIM中模式的设计。

现在首先知道VIM中三种最常用的模式，分别为：普通模式（也可称为命令模式）、插入模式（可以称为编辑模式）、Ex模式，其他的模式以后再说。

-   **普通模式**  
    一般打开VIM后，默认就在普通模式下。VIM运行在该模式时，键入的内容会被识别为VIM命令并被VIM执行，而不是像传统的编辑器那样直接输入键入的内容。比如在普通模式下键入dd会被VIM解释为删除当前行的命令，而不是输入dd两个字符。
-   **插入模式**  
    在插入模式下，VIM表现的和传统编辑器一样，键入的内容会直接输入到编辑的文件中，这个模式很好理解，不多解释。
-   **Ex模式**  
    在该模式下可以使用更多命令，包括执行命令（“:”）、搜索（“/”或者“?”）、存储文件、替换文本、甚至执行shell命令等，通常在Ex模式下的命令输入后要**按下回车**以执行。在命令执行后，VIM返回到进入Ex模式之前的模式（如果还有返回的话），通常是普通模式。比如Ex模式下执行的命令`:w`会保存当前编辑的文件然后返回之前的模式，而`:wq`会保存当前文件并退出VIM。

简单的说，VIM在普通模式下，按下键盘上的字母时会执行一些特定的VIM命令；在插入模式下，键盘的按键操作会直接输入到文件中；而Ex命令下可以执行更多更复杂的命令。所以如果你在VIM中发现按键输入的效果完全混乱不可理解，请先检查并确保你是否已经进入插入模式。

VIM切换不同模式的方法有很多，但是现在先记住下面的几个简单规则：

-   不管在哪种模式下，按下`ESC`键会转到普通模式。（有些情况下可能要按两次`ESC`，不过无论在什么情况下，连续按下两次`ESC`就一定能转到普通模式下。
-   在普通模式下要键入`i`、`a`、`o`这几个键都可以进入插入模式，只是进入插入模式时光标所在位置不同，关于这些差异后面再详说。
-   VIM打开时默认是在普通模式下。

>   重要的事情说三遍：VIM有不同模式，VIM有不同模式，VIM有不同模式！

命令行下直接键入vim就可以运行VIM编辑器，初始界面如下图，默认是在普通模式。

![](/resource/vim_001.png)

普通模式下键入`i`，会进入插入模式，可以看到最下面一行显示“-- INSERT --”。

![](/resource/vim_002.png)

按下`ESC`返回普通模式，然后键入`:`进入Ex模式，光标会自动移动到最底下的一行，在这里输入`wq`就是要保存并退出VIM。

![](/resource/vim_003.png)

## 基本操作

VIM的高效和强大最能在普通模式下体现出来，下面介绍的操作若无特殊说明都是在普通模式下完成的，所有的操作都区分大小写。

### 移动光标

-   `h` 向左移动一个字
-   `j` 向下移动一行
-   `k` 向上移动一行
-   `l` 向右移动一个字

这几个按键在右手最容易碰到的位置（可能设计时没考虑左撇子的感受），所以用作移动光标的最常用命令。

### 编辑

-   `i` 进入插入模式，**i**nsert，按下`ESC`可以返回普通模式。
-   `x` 删除光标所在的字符（这是沿用以前打字机的用法）
-   `dd` 删除光标当前行

在编辑模式下，上下左右方向键以及删除（Delete）、退格（Backspace）键等也可以用于控制光标或者删除内容

### 存储文件（Ex模式）

-   `:w` 保存当前所有修改（w后可以跟文件名），**w**rite
-   `:q` 退出当前vim窗口（如果有未保存的修改，`:q`无法直接退出，可以用`:q!`强制不保存而退出），**q**uit
-   `:wq` 顾名思义，先保存再退出
-   `:x` 和`:wq`作用一样

好了，知道了这几个命令，已经可以在VIM中编辑文件了，但是只了解这几个命令相当于把VIM当成传统的文本编辑器，那用起来肯定会抱怨太麻烦而且效率不高。别急，下一篇就告诉你如何高效的使用VIM这个神器！
